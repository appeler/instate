<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Welcome to instate’s documentation! &#8212; instate 0.1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=92734c54"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="instate" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="welcome-to-instate-s-documentation">
<h1>Welcome to instate’s documentation!<a class="headerlink" href="#welcome-to-instate-s-documentation" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">instate</a><ul class="simple">
</ul>
</li>
</ul>
</div>
</section>
<section id="instate-predict-spoken-language-and-the-state-of-residence-from-last-name">
<h1>instate: predict spoken language and the state of residence from last name<a class="headerlink" href="#instate-predict-spoken-language-and-the-state-of-residence-from-last-name" title="Link to this heading">¶</a></h1>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/instate"><img alt="https://img.shields.io/pypi/v/instate.svg" src="https://img.shields.io/pypi/v/instate.svg" />
</a>
<a class="reference external image-reference" href="http://instate.readthedocs.io/en/latest/?badge=latest"><img alt="Documentation Status" src="https://readthedocs.org/projects/instate/badge/?version=latest" />
</a>
<a class="reference external image-reference" href="https://pepy.tech/project/instate"><img alt="https://static.pepy.tech/badge/instate" src="https://static.pepy.tech/badge/instate" />
</a>
<p>Using the Indian electoral rolls data (2017), we provide a Python package that takes the last name of a person and gives its distribution across states.
This package can also predict the spoken language of the person based on the last name.</p>
<section id="potential-use-cases">
<h2>Potential Use Cases<a class="headerlink" href="#potential-use-cases" title="Link to this heading">¶</a></h2>
<p>India has 22 official languages. To serve such a diverse language base is a challenge for businesses and surveyors. To the extent that businesses have access to the last name (and no other information) and in the absence of other data that allows us to model a person’s spoken language, the distribution of last names across states is the best we have.</p>
</section>
<section id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">¶</a></h2>
<p>Refer <a class="reference external" href="https://github.com/appeler/instate/blob/main/instate/data/lastname_langs_india.csv.tar.gz">lastname_langs_india.csv.tar.gz</a> for the dataset, that will be used to predict/lookup the spoken language based on the last name.</p>
<p>Refer <a class="reference external" href="https://github.com/appeler/instate/blob/main/instate/data/lastname_langs_india_top3.csv.tar.gz">lastname_langs_india_top3.csv.tar.gz</a> for the dataset, that will be used to predict the top-3 spoken languages based on the last name. A LSTM model has been trained on this dataset to predict the top-3 spoken languages.</p>
<p>Refer <a class="reference external" href="https://github.com/appeler/instate/tree/main/instate/notebooks">notebooks</a> for the notebooks that were used to prepare above datasets and train the models.</p>
</section>
<section id="web-ui">
<h2>Web UI<a class="headerlink" href="#web-ui" title="Link to this heading">¶</a></h2>
<p>Streamlit App.: <a class="reference external" href="https://appeler-instate-streamlitstreamlit-app-e39m4c.streamlit.app/">https://appeler-instate-streamlitstreamlit-app-e39m4c.streamlit.app/</a></p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>We strongly recommend installing <cite>instate</cite> inside a Python virtual environment
(see <a class="reference external" href="https://docs.python.org/3/library/venv.html#creating-virtual-environments">venv documentation</a>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">instate</span>
</pre></div>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">instate</span><span class="w"> </span><span class="kn">import</span> <span class="n">last_state</span>
<span class="n">last_dat</span> <span class="o">&lt;-</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;last_dat.csv&quot;</span><span class="p">)</span>
<span class="n">last_state_dat</span> <span class="o">&lt;-</span> <span class="n">last_state</span><span class="p">(</span><span class="n">last_dat</span><span class="p">,</span> <span class="s2">&quot;dhingra&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">last_state_dat</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Link to this heading">¶</a></h2>
<p>instate exposes 5 functions.</p>
<ul>
<li><p><strong>last_state</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>takes a pandas dataframe, the column name for the df column with the last names, and produces a dataframe with 31 more columns, reflecting the number of states for which we have the data.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">instate</span><span class="w"> </span><span class="kn">import</span> <span class="n">last_state</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Dhingra&#39;</span><span class="p">,</span> <span class="s1">&#39;Sood&#39;</span><span class="p">,</span> <span class="s1">&#39;Gowda&#39;</span><span class="p">]})</span>
<span class="n">last_state</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span> <span class="mi">5</span><span class="p">]</span>

    <span class="n">last_name</span>   <span class="n">__last_name</span> <span class="n">andaman</span>     <span class="n">andhra</span>      <span class="n">arunachal</span>
<span class="mi">0</span>   <span class="n">Dhingra</span>     <span class="n">dhingra</span>     <span class="mf">0.001737</span>    <span class="mf">0.000744</span>    <span class="mf">0.000000</span>
<span class="mi">1</span>   <span class="n">Sood</span>        <span class="n">sood</span>        <span class="mf">0.000258</span>    <span class="mf">0.002492</span>    <span class="mf">0.000043</span>
<span class="mi">2</span>   <span class="n">Gowda</span>       <span class="n">gowda</span>       <span class="mf">0.000000</span>    <span class="mf">0.528533</span>    <span class="mf">0.000000</span>
</pre></div>
</div>
<ul>
<li><p><strong>pred_last_state</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>takes a pandas dataframe, the column name with the last names, and produces a dataframe with 1 more column (pred_state), reflecting the top-3 predictions from GRU model.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">instate</span><span class="w"> </span><span class="kn">import</span> <span class="n">pred_last_state</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Dhingra&#39;</span><span class="p">,</span> <span class="s1">&#39;Sood&#39;</span><span class="p">,</span> <span class="s1">&#39;Gowda&#39;</span><span class="p">]})</span>
<span class="n">last_state</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">last_name</span>       <span class="n">pred_state</span>
<span class="mi">0</span>   <span class="n">dhingra</span> <span class="p">[</span><span class="n">Daman</span> <span class="ow">and</span> <span class="n">Diu</span><span class="p">,</span> <span class="n">Andaman</span> <span class="ow">and</span> <span class="n">Nicobar</span> <span class="n">Islands</span><span class="p">,</span> <span class="n">Puducherry</span><span class="p">]</span>
<span class="mi">1</span>   <span class="n">sood</span>    <span class="p">[</span><span class="n">Meghalaya</span><span class="p">,</span> <span class="n">Chandigarh</span><span class="p">,</span> <span class="n">Punjab</span><span class="p">]</span>
<span class="mi">2</span>   <span class="n">gowda</span>   <span class="p">[</span><span class="n">Puducherry</span><span class="p">,</span> <span class="n">Nagaland</span><span class="p">,</span> <span class="n">Daman</span> <span class="ow">and</span> <span class="n">Diu</span><span class="p">]</span>
</pre></div>
</div>
<ul>
<li><p><strong>state_to_lang</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>takes a pandas dataframe, the column name with the state, and appends census mappings from state to languages</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">instate</span><span class="w"> </span><span class="kn">import</span> <span class="n">state_to_lang</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;dhingra&#39;</span><span class="p">,</span> <span class="s1">&#39;sood&#39;</span><span class="p">,</span> <span class="s1">&#39;gowda&#39;</span><span class="p">]})</span>
<span class="n">state_last</span> <span class="o">=</span> <span class="n">last_state</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">)</span>
<span class="n">small_state</span> <span class="o">=</span> <span class="n">state_last</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;andaman&quot;</span><span class="p">:</span><span class="s2">&quot;utt&quot;</span><span class="p">]</span>
<span class="n">state_last</span><span class="p">[</span><span class="s2">&quot;modal_state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">small_state</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">state_to_lang</span><span class="p">(</span><span class="n">state_last</span><span class="p">,</span> <span class="s2">&quot;modal_state&quot;</span><span class="p">)[[</span><span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;modal_state&quot;</span><span class="p">,</span> <span class="s2">&quot;official_languages&quot;</span><span class="p">]]</span>

      <span class="n">last_name</span>   <span class="n">modal_state</span> <span class="n">official_languages</span>
  <span class="mi">0</span>   <span class="n">dhingra</span>     <span class="n">delhi</span>       <span class="n">Hindi</span><span class="p">,</span> <span class="n">English</span>
  <span class="mi">1</span>   <span class="n">sood</span>        <span class="n">punjab</span>      <span class="n">Punjabi</span>
  <span class="mi">2</span>   <span class="n">gowda</span>       <span class="n">andhra</span>      <span class="n">Telugu</span>
</pre></div>
</div>
<ul>
<li><p><strong>lookup_lang</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>takes a pandas dataframe, the column name with the last names, and produces a dataframe with 1 more column (lang), reflecting the most spoken language in the state. This method will find nearest names and then look up in dataset to find the most spoken language.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="kn">from</span><span class="w"> </span><span class="nn">instate</span><span class="w"> </span><span class="kn">import</span> <span class="n">lookup_lang</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sood&#39;</span><span class="p">,</span> <span class="s1">&#39;chintalapati&#39;</span><span class="p">]})</span>
  <span class="n">lookup_lang</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">)</span>

        <span class="n">last_name</span> <span class="n">predicted_lang</span>
<span class="mi">0</span>          <span class="n">sood</span>          <span class="n">hindi</span>
<span class="mi">1</span>  <span class="n">chintalapati</span>         <span class="n">telugu</span>
</pre></div>
</div>
<ul>
<li><p><strong>predict_lang</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>takes a pandas dataframe, the column name with the last names, and produces a dataframe with 1 more column (lang), reflecting the most spoken language in the state. This method will predict the language based on the names.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="kn">from</span><span class="w"> </span><span class="nn">instate</span><span class="w"> </span><span class="kn">import</span> <span class="n">predict_lang</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sood&#39;</span><span class="p">,</span> <span class="s1">&#39;chintalapati&#39;</span><span class="p">]})</span>
  <span class="n">predict_lang</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">)</span>

        <span class="n">last_name</span> <span class="n">predicted_lang</span>
<span class="mi">0</span>          <span class="n">sood</span>   <span class="p">[</span><span class="n">hindi</span><span class="p">,</span> <span class="n">punjabi</span><span class="p">,</span> <span class="n">urdu</span><span class="p">]</span>
<span class="mi">1</span>  <span class="n">chintalapati</span>  <span class="p">[</span><span class="n">telugu</span><span class="p">,</span> <span class="n">urdu</span><span class="p">,</span> <span class="n">chenchu</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">¶</a></h2>
<p>The underlying data for the package can be accessed at: <a class="reference external" href="https://doi.org/10.7910/DVN/ZXMVTJ">https://doi.org/10.7910/DVN/ZXMVTJ</a></p>
</section>
<section id="evaluation">
<h2>Evaluation<a class="headerlink" href="#evaluation" title="Link to this heading">¶</a></h2>
<p>The model has a top-3 accuracy of 85.3% on <a class="reference external" href="https://github.com/appeler/instate/blob/main/instate/models/model_dnn_gpu.ipynb">unseen names</a>. The KNN model does quite well. See the details <a class="reference external" href="https://github.com/appeler/instate/blob/main/instate/models/KNN_cosine_distance_simple_avg_modal_state.ipynb">here</a>
The name-to-language lookup has an accuracy of 67.9%.
The name-to-language model prediction has an accuracy of 72.2%.</p>
</section>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Link to this heading">¶</a></h2>
<p>Atul Dhingra, Gaurav Sood and Rajashekar Chintalapati</p>
</section>
<section id="contributor-code-of-conduct">
<h2>Contributor Code of Conduct<a class="headerlink" href="#contributor-code-of-conduct" title="Link to this heading">¶</a></h2>
<p>The project welcomes contributions from everyone! In fact, it depends on
it. To maintain this welcoming atmosphere, and to collaborate in a fun
and productive way, we expect contributors to the project to abide by
the <a class="reference external" href="http://contributor-covenant.org/version/1/0/0/">Contributor Code of
Conduct</a>.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p>The package is released under the <a class="reference external" href="https://opensource.org/licenses/MIT">MIT
License</a>.</p>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">instate</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">instate</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="modules.html" title="next chapter">instate</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, atul dhingra and gaurav sood.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>